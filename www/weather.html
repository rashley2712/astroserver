<html>
    <head>
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-52663594-2"></script>
		<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
		<script language="javascript" type="text/javascript" src="meteodbcharts.js"></script>
      
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            
            gtag('config', 'UA-52663594-2');
        </script>
        
        <title>AstroFarm, Weather information</title>
        <link rel="stylesheet" type="text/css" href="styles.css"/>
     	
        <script src="astrotools.js"></script>
        
        <script language="Javascript">
            // Global variables
            var currentDate = new Date();
            var availableDates = null;
            var secondsTimerId = null;
			var minutesTimerId = null;
			var startDate = null;
			var endDate = null;
            var meteoData = {};
            var dayData = null;
            var prevDayData = false;
            var currentDateIndex = -1;
            var chartLoaded = false;
            var chart;
            var lastJSONURL;
            var dataRefreshTimerId = null;
            
            // Import Google Charts
            google.charts.load('current', {'packages':['corechart', 'timeline']});
            google.charts.setOnLoadCallback(function() { chartLoaded = true;});

            // Call a function only when the page is fully loaded.
		    document.addEventListener('readystatechange', event => {
		        if (event.target.readyState === "complete") {
			        onLoad();
		        }
		    });
                
            function onLoad() {
                console.log("The page has loaded....");
				console.log("Current time is:", currentDate);
				getJSON('menu.json', drawMenu);
				getJSON("/LPmeteo/meteodb.json", dataUpdate);
            }

			function dataUpdate(err, data) {
				console.log(data);
				document.getElementById("temperature").innerText = data.temperature.value;
				document.getElementById("humidity").innerText = data.humidity.value;
			}
      

</script>
</head>

<body>
    <a href="/"><img src="astrofarmlogo.png" width="300" style="position:absolute; top:0; left:0;"></a>
    <div id="menu" style="position:absolute; top:10; left:320; z-index:1">
        ... loading menu ... 
    </div>
    <p>&nbsp;</p>
    <p>&nbsp;</p>
    <p>&nbsp;</p>
    <p>&nbsp;</p>
	<p>&nbsp;</p>
	<p>Current local weather</p>
	<table style="width: 900px;" border="1">
		<tr>
			<td>Temperature <span id="temperature">--</span>&deg;C</td>
			<td>Relative humidity <span id="humidity">--</span>%</td>
		</tr>
	</table>
	<table style="width: 900px;">
        <!--<tr>
            <td align="right" colspan=3><input onchange="togglePrevDay()" type="checkbox" id="prevday"><label for="prevday">overlay previous day's data</label></td>
        </tr>-->
        <tr align="center">
            <td id="menuCell" onclick="shiftDay(-1)">&lt;&lt;</td>
            <td id="menuCell"><span id="chartDate">date</span></td>
            <td id="menuCell" onclick="shiftDay(1)">&gt;&gt;</td>
        </tr>
		
	</table>
	<table>
		<tr>
			<td>
				<div id="chart_temperature" style="width: 900px; height: 300px;"></div>
			</td>
		</tr>
		<tr>
			<td>
				<div id="chart_humidity" style="width: 900px; height: 250px;"></div>
			</td>
		</tr>
		<tr>
			<td>
				<div id="chart_pressure" style="width: 900px; height: 250px;"></div>
			</td>
        </tr>
        <tr>
			<td>
				<div id="chart_CPU" style="width: 900px; height: 250px;"></div>
			</td>
		</tr>
	</table>
    <p id='footer'>
    
    </p>
</body>
<!--  style="border:1px solid #ffffff;-->
</html>
